{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\if994249\\\\eclipse-workspace\\\\song-drop\\\\song-drop-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\if994249\\\\eclipse-workspace\\\\song-drop\\\\song-drop-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:\\\\Users\\\\if994249\\\\eclipse-workspace\\\\song-drop\\\\song-drop-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\if994249\\\\eclipse-workspace\\\\song-drop\\\\song-drop-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\if994249\\\\eclipse-workspace\\\\song-drop\\\\song-drop-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\if994249\\\\eclipse-workspace\\\\song-drop\\\\song-drop-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"C:\\\\Users\\\\if994249\\\\eclipse-workspace\\\\song-drop\\\\song-drop-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\if994249\\\\eclipse-workspace\\\\song-drop\\\\song-drop-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import Dropzone from'./dropzone/Dropzone';var Upload=/*#__PURE__*/function(_Component){_inherits(Upload,_Component);function Upload(props){var _this;_classCallCheck(this,Upload);_this=_possibleConstructorReturn(this,_getPrototypeOf(Upload).call(this,props));_this.state={files:[]};_this.uploadFiles=_this.uploadFiles.bind(_assertThisInitialized(_this));_this.sendRequest=_this.sendRequest.bind(_assertThisInitialized(_this));_this.onFilesAdded=_this.onFilesAdded.bind(_assertThisInitialized(_this));return _this;}_createClass(Upload,[{key:\"onFilesAdded\",value:function onFilesAdded(files){var _this2=this;this.setState(function(prevState){return{files:prevState.files.concat(files)};});setTimeout(function(){console.log(_this2.state.files);_this2.uploadFiles();},0);}},{key:\"uploadFiles\",value:function(){var _uploadFiles=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this3=this;var promises;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:promises=[];this.state.files.forEach(function(file){promises.push(_this3.sendRequest(file));console.log(promises);});_context.prev=2;_context.next=5;return Promise.all(promises);case 5:this.setState({files:undefined});_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](2);console.log(_context.t0);case 11:case\"end\":return _context.stop();}}},_callee,this,[[2,8]]);}));function uploadFiles(){return _uploadFiles.apply(this,arguments);}return uploadFiles;}()},{key:\"sendRequest\",value:function sendRequest(file){return new Promise(function(res,rej){var req=new XMLHttpRequest();var formData=new FormData();formData.append(\"file\",file,file.name);req.open(\"POST\",\"http://172.18.86.35:5001/upload\");req.send(formData);});}},{key:\"render\",value:function render(){return React.createElement(Dropzone,{onFilesAdded:this.onFilesAdded,disabled:false});}}]);return Upload;}(Component);export default Upload;","map":{"version":3,"sources":["C:/Users/if994249/eclipse-workspace/song-drop/song-drop-app/src/Upload.js"],"names":["React","Component","Dropzone","Upload","props","state","files","uploadFiles","bind","sendRequest","onFilesAdded","setState","prevState","concat","setTimeout","console","log","promises","forEach","file","push","Promise","all","undefined","res","rej","req","XMLHttpRequest","formData","FormData","append","name","open","send"],"mappings":"2sCAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAOC,CAAAA,QAAP,KAAqB,qBAArB,C,GAEMC,CAAAA,M,gEAEJ,gBAAYC,KAAZ,CAAmB,wCACjB,wEAAMA,KAAN,GACA,MAAKC,KAAL,CAAa,CACXC,KAAK,CAAE,EADI,CAAb,CAIA,MAAKC,WAAL,CAAmB,MAAKA,WAAL,CAAiBC,IAAjB,+BAAnB,CACA,MAAKC,WAAL,CAAmB,MAAKA,WAAL,CAAiBD,IAAjB,+BAAnB,CACA,MAAKE,YAAL,CAAoB,MAAKA,YAAL,CAAkBF,IAAlB,+BAApB,CARiB,aASlB,C,qEAEYF,K,CAAO,iBAClB,KAAKK,QAAL,CAAc,SAAAC,SAAS,QAAK,CAC1BN,KAAK,CAAEM,SAAS,CAACN,KAAV,CAAgBO,MAAhB,CAAuBP,KAAvB,CADmB,CAAL,EAAvB,EAGAQ,UAAU,CAAC,UAAM,CAAEC,OAAO,CAACC,GAAR,CAAY,MAAI,CAACX,KAAL,CAAWC,KAAvB,EAA+B,MAAI,CAACC,WAAL,GAAqB,CAA7D,CAA+D,CAA/D,CAAV,CACD,C,+QAGOU,Q,CAAW,E,CACjB,KAAKZ,KAAL,CAAWC,KAAX,CAAiBY,OAAjB,CAAyB,SAAAC,IAAI,CAAI,CAC/BF,QAAQ,CAACG,IAAT,CAAc,MAAI,CAACX,WAAL,CAAiBU,IAAjB,CAAd,EACAJ,OAAO,CAACC,GAAR,CAAYC,QAAZ,EACD,CAHD,E,sCAKQI,CAAAA,OAAO,CAACC,GAAR,CAAYL,QAAZ,C,QACN,KAAKN,QAAL,CAAc,CAAEL,KAAK,CAAEiB,SAAT,CAAd,E,+EAEAR,OAAO,CAACC,GAAR,c,+MAIQG,I,CAAM,CAChB,MAAO,IAAIE,CAAAA,OAAJ,CAAY,SAACG,GAAD,CAAMC,GAAN,CAAc,CAC/B,GAAMC,CAAAA,GAAG,CAAG,GAAIC,CAAAA,cAAJ,EAAZ,CAEA,GAAMC,CAAAA,QAAQ,CAAG,GAAIC,CAAAA,QAAJ,EAAjB,CACAD,QAAQ,CAACE,MAAT,CAAgB,MAAhB,CAAwBX,IAAxB,CAA8BA,IAAI,CAACY,IAAnC,EAEAL,GAAG,CAACM,IAAJ,CAAS,MAAT,CAAiB,iCAAjB,EACAN,GAAG,CAACO,IAAJ,CAASL,QAAT,EACD,CARM,CAAP,CASD,C,uCAEQ,CACP,MACE,qBAAC,QAAD,EAAU,YAAY,CAAE,KAAKlB,YAA7B,CAA2C,QAAQ,CAAE,KAArD,EADF,CAGD,C,oBAlDkBT,S,EAsDrB,cAAeE,CAAAA,MAAf","sourcesContent":["import React, { Component } from \"react\";\r\nimport Dropzone from './dropzone/Dropzone';\r\n\r\nclass Upload extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      files: []\r\n    };\r\n    \r\n    this.uploadFiles = this.uploadFiles.bind(this);\r\n    this.sendRequest = this.sendRequest.bind(this);\r\n    this.onFilesAdded = this.onFilesAdded.bind(this);\r\n  }\r\n  \r\n  onFilesAdded(files) {\r\n    this.setState(prevState => ({\r\n      files: prevState.files.concat(files)\r\n    }));\r\n    setTimeout(() => { console.log(this.state.files); this.uploadFiles(); }, 0);\r\n  }\r\n\r\n  async uploadFiles() {\r\n    const promises = [];\r\n    this.state.files.forEach(file => {\r\n      promises.push(this.sendRequest(file));\r\n      console.log(promises);\r\n    });\r\n    try {\r\n      await Promise.all(promises);\r\n      this.setState({ files: undefined });\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  }\r\n  \r\n  sendRequest(file) {\r\n    return new Promise((res, rej) => {\r\n      const req = new XMLHttpRequest();\r\n      \r\n      const formData = new FormData();\r\n      formData.append(\"file\", file, file.name);\r\n      \r\n      req.open(\"POST\", \"http://172.18.86.35:5001/upload\");\r\n      req.send(formData);\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Dropzone onFilesAdded={this.onFilesAdded} disabled={false} />\r\n    );\r\n  }\r\n\r\n}\r\n\r\nexport default Upload;"]},"metadata":{},"sourceType":"module"}